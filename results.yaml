- account: yatas
  checks:
    - name: ACM certificates are valid
      description: Check if certificate is valid
      status: OK
      id: AWS_ACM_001
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.155µs
      starttime: 2022-11-07T23:00:14.148744+01:00
      endtime: 2022-11-07T23:00:04.609947+01:00
    - name: ACM certificate expires in more than 90 days
      description: Check if certificate expires in 90 days
      status: OK
      id: AWS_ACM_002
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.069µs
      starttime: 2022-11-07T23:00:14.148745+01:00
      endtime: 2022-11-07T23:00:04.609948+01:00
    - name: ACM certificates are used
      description: Check if certificate is in use
      status: OK
      id: AWS_ACM_003
      categories:
        - Security
        - Good Practice
      results: []
      duration: 2.158µs
      starttime: 2022-11-07T23:00:14.148753+01:00
      endtime: 2022-11-07T23:00:04.609951+01:00
    - name: ApiGateways logs are sent to Cloudwatch
      description: Check if all cloudwatch logs are enabled for all stages
      status: OK
      id: AWS_APG_001
      categories:
        - Security
        - Good Practice
      results: []
      duration: 2.445µs
      starttime: 2022-11-07T23:00:14.14879+01:00
      endtime: 2022-11-07T23:00:04.698137+01:00
    - name: ApiGateways are protected by an ACL
      description: Check if all stages are protected by ACL
      status: OK
      id: AWS_APG_002
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.256µs
      starttime: 2022-11-07T23:00:14.14879+01:00
      endtime: 2022-11-07T23:00:04.69814+01:00
    - name: ApiGateways have tracing enabled
      description: Check if all stages are enabled for tracing
      status: OK
      id: AWS_APG_003
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.237µs
      starttime: 2022-11-07T23:00:14.14879+01:00
      endtime: 2022-11-07T23:00:04.698143+01:00
    - name: Autoscaling maximum capacity is below 80%
      description: Check if all autoscaling groups have a desired capacity below 80%
      status: OK
      id: AWS_ASG_001
      categories:
        - Security
        - Good Practice
      results: []
      duration: 3.884µs
      starttime: 2022-11-07T23:00:14.148791+01:00
      endtime: 2022-11-07T23:00:04.785829+01:00
    - name: Autoscaling group are in two availability zones
      description: Check if all autoscaling groups have at least two availability zones
      status: OK
      id: AWS_ASG_002
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.625µs
      starttime: 2022-11-07T23:00:14.148791+01:00
      endtime: 2022-11-07T23:00:04.78585+01:00
    - name: EC2's Snapshots are encrypted
      description: Check if all snapshots are encrypted
      status: OK
      id: AWS_BAK_001
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.623µs
      starttime: 2022-11-07T23:00:14.148819+01:00
      endtime: 2022-11-07T23:00:05.058046+01:00
    - name: EC2's snapshots are younger than a day old
      description: Check if all snapshots are younger than 24h
      status: FAIL
      id: AWS_BAK_002
      categories:
        - Security
        - Good Practice
      results:
        - message: Volume vol-05e2ed98f2cb26bc7 has no snapshot younger than 24h
          status: FAIL
          resource_arn: vol-05e2ed98f2cb26bc7
      duration: 3.207µs
      starttime: 2022-11-07T23:00:14.148819+01:00
      endtime: 2022-11-07T23:00:05.058059+01:00
    - name: Cloudfronts enforce TLS 1.2 at least
      description: Check if all cloudfront distributions have TLS 1.2 minimum
      status: FAIL
      id: AWS_CFT_001
      categories:
        - Security
        - Good Practice
      results:
        - message: TLS 1.2 minimum is not set on E20RPP2IKLA262
          status: FAIL
          resource_arn: E20RPP2IKLA262
      duration: 10.761µs
      starttime: 2022-11-07T23:00:14.14882+01:00
      endtime: 2022-11-07T23:00:05.153859+01:00
    - name: Cloudfronts only allow HTTPS or redirect to HTTPS
      description: Check if all cloudfront distributions are HTTPS only
      status: OK
      id: AWS_CFT_002
      categories:
        - Security
        - Good Practice
      results:
        - message: Cloudfront distribution is HTTPS only on E20RPP2IKLA262
          status: OK
          resource_arn: E20RPP2IKLA262
      duration: 15.903µs
      starttime: 2022-11-07T23:00:14.148821+01:00
      endtime: 2022-11-07T23:00:05.153863+01:00
    - name: Cloudfronts queries are logged
      description: Check if all cloudfront distributions have standard logging enabled
      status: FAIL
      id: AWS_CFT_003
      categories:
        - Security
        - Good Practice
      results:
        - message: Standard logging is not enabled on E20RPP2IKLA262
          status: FAIL
          resource_arn: E20RPP2IKLA262
      duration: 6.298µs
      starttime: 2022-11-07T23:00:14.148822+01:00
      endtime: 2022-11-07T23:00:05.153885+01:00
    - name: Cloudfronts are logging Cookies
      description: Check if all cloudfront distributions have cookies logging enabled
      status: FAIL
      id: AWS_CFT_004
      categories:
        - Security
        - Good Practice
      results:
        - message: Cookie logging is not enabled on E20RPP2IKLA262
          status: FAIL
          resource_arn: E20RPP2IKLA262
      duration: 14.952µs
      starttime: 2022-11-07T23:00:14.148822+01:00
      endtime: 2022-11-07T23:00:05.153884+01:00
    - name: Cloudfronts are protected by an ACL
      description: Check if all cloudfront distributions have an ACL used
      status: OK
      id: AWS_CFT_005
      categories:
        - Security
        - Good Practice
      results:
        - message: ACL is used on E20RPP2IKLA262
          status: OK
          resource_arn: E20RPP2IKLA262
      duration: 3.764µs
      starttime: 2022-11-07T23:00:14.148821+01:00
      endtime: 2022-11-07T23:00:05.153873+01:00
    - name: Cloudtrails are encrypted
      description: check if all cloudtrails are encrypted
      status: OK
      id: AWS_CLD_001
      categories:
        - Security
        - Good Practice
      results:
        - message: Cloudtrail test is encrypted
          status: OK
          resource_arn: arn:aws:cloudtrail:eu-west-2:766369807176:trail/test
      duration: 6.042µs
      starttime: 2022-11-07T23:00:14.148776+01:00
      endtime: 2022-11-07T23:00:04.665148+01:00
    - name: Cloudtrails have Global Service Events Activated
      description: check if all cloudtrails have global service events enabled
      status: OK
      id: AWS_CLD_002
      categories:
        - Security
        - Good Practice
      results:
        - message: Cloudtrail test has global service events enabled
          status: OK
          resource_arn: arn:aws:cloudtrail:eu-west-2:766369807176:trail/test
      duration: 14.779µs
      starttime: 2022-11-07T23:00:14.148777+01:00
      endtime: 2022-11-07T23:00:04.665204+01:00
    - name: Cloudtrails are in multiple regions
      description: check if all cloudtrails are multi region
      status: OK
      id: AWS_CLD_003
      categories:
        - Security
        - Good Practice
      results:
        - message: Cloudtrail test is multi region
          status: OK
          resource_arn: arn:aws:cloudtrail:eu-west-2:766369807176:trail/test
      duration: 2.467µs
      starttime: 2022-11-07T23:00:14.148777+01:00
      endtime: 2022-11-07T23:00:04.665155+01:00
    - name: Cognito allows unauthenticated users
      description: Check if Cognito allows unauthenticated users
      status: OK
      id: AWS_COG_001
      categories:
        - Security
        - Good Practice
      results: []
      duration: 3.815µs
      starttime: 2022-11-07T23:00:14.148778+01:00
      endtime: 2022-11-07T23:00:04.670024+01:00
    - name: Dynamodbs are encrypted
      description: Check if DynamoDB encryption is enabled
      status: OK
      id: AWS_DYN_001
      categories:
        - Security
        - Good Practice
      results: []
      duration: 3.972µs
      starttime: 2022-11-07T23:00:14.148791+01:00
      endtime: 2022-11-07T23:00:04.705311+01:00
    - name: Dynamodb have continuous backup enabled with PITR
      description: Check if DynamoDB continuous backups are enabled
      status: OK
      id: AWS_DYN_002
      categories:
        - Security
        - Good Practice
      results: []
      duration: 7.847µs
      starttime: 2022-11-07T23:00:14.148791+01:00
      endtime: 2022-11-07T23:00:04.705336+01:00
    - name: EC2s don't have a public IP
      description: Check if all instances have a public IP
      status: FAIL
      id: AWS_EC2_001
      categories:
        - Security
        - Good Practice
      results:
        - message: EC2 instance i-06f4d2f33625d1482 has a public IP13.36.166.10
          status: FAIL
          resource_arn: i-06f4d2f33625d1482
      duration: 5.419µs
      starttime: 2022-11-07T23:00:14.148792+01:00
      endtime: 2022-11-07T23:00:04.847583+01:00
    - name: EC2s have the monitoring option enabled
      description: Check if all instances have monitoring enabled
      status: FAIL
      id: AWS_EC2_002
      categories:
        - Security
        - Good Practice
      results:
        - message: EC2 instance i-06f4d2f33625d1482 has no monitoring enabled
          status: FAIL
          resource_arn: i-06f4d2f33625d1482
      duration: 10.903µs
      starttime: 2022-11-07T23:00:14.148792+01:00
      endtime: 2022-11-07T23:00:04.847605+01:00
    - name: ECRs image are scanned on push
      description: Check if all ECRs have image scanning enabled
      status: FAIL
      id: AWS_ECR_001
      categories:
        - Security
        - Good Practice
      results:
        - message: ECR cdk-hnb659fds-container-assets-056984988198-eu-west-3 has image scanning disabled
          status: FAIL
          resource_arn: cdk-hnb659fds-container-assets-056984988198-eu-west-3
      duration: 2.95µs
      starttime: 2022-11-07T23:00:14.14876+01:00
      endtime: 2022-11-07T23:00:04.646361+01:00
    - name: ECRs are encrypted
      description: Check if all ECRs are encrypted
      status: OK
      id: AWS_ECR_002
      categories:
        - Security
        - Good Practice
      results:
        - message: ECR cdk-hnb659fds-container-assets-056984988198-eu-west-3 is encrypted
          status: OK
          resource_arn: cdk-hnb659fds-container-assets-056984988198-eu-west-3
      duration: 1.914µs
      starttime: 2022-11-07T23:00:14.148769+01:00
      endtime: 2022-11-07T23:00:04.646612+01:00
    - name: ECRs tags are immutable
      description: Check if all ECRs are tag immutable
      status: OK
      id: AWS_ECR_003
      categories:
        - Security
        - Good Practice
      results:
        - message: ECR cdk-hnb659fds-container-assets-056984988198-eu-west-3 is tag immutable
          status: OK
          resource_arn: cdk-hnb659fds-container-assets-056984988198-eu-west-3
      duration: 7.039µs
      starttime: 2022-11-07T23:00:14.148761+01:00
      endtime: 2022-11-07T23:00:04.646603+01:00
    - name: EKS clusters have logging enabled
      description: Check if logging is enabled
      status: OK
      id: AWS_EKS_001
      categories:
        - Security
        - Good Practice
      results: []
      duration: 4.029µs
      starttime: 2022-11-07T23:00:14.148778+01:00
      endtime: 2022-11-07T23:00:04.677133+01:00
    - name: EKS clusters have private endpoint or strict public access
      description: Check if EKS clusters have private endpoint
      status: OK
      id: AWS_EKS_002
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.76µs
      starttime: 2022-11-07T23:00:14.148778+01:00
      endtime: 2022-11-07T23:00:04.677138+01:00
    - name: ELB have access logs enabled
      description: Check if all load balancers have access logs enabled
      status: OK
      id: AWS_ELB_001
      categories:
        - Security
        - Good Practice
      results: []
      duration: 2.568µs
      starttime: 2022-11-07T23:00:14.148779+01:00
      endtime: 2022-11-07T23:00:04.693815+01:00
    - name: GuardDuty is enabled in the account
      description: Check if GuardDuty is enabled
      status: FAIL
      id: AWS_GDT_001
      categories:
        - Security
        - Good Practice
      results:
        - message: GuardDuty is not enabled
          status: FAIL
          resource_arn: ""
      duration: 4.344µs
      starttime: 2022-11-07T23:00:14.148777+01:00
      endtime: 2022-11-07T23:00:04.669667+01:00
    - name: IAM Users have 2FA activated
      description: Check if all users have 2FA activated
      status: FAIL
      id: AWS_IAM_001
      categories:
        - Security
        - Good Practice
      results:
        - message: 2FA is activated on anaell
          status: OK
          resource_arn: anaell
        - message: 2FA is activated on antoinea@padok.fr
          status: OK
          resource_arn: antoinea@padok.fr
        - message: 2FA is activated on arthurh
          status: OK
          resource_arn: arthurh
        - message: 2FA is activated on aurelienv
          status: OK
          resource_arn: aurelienv
        - message: 2FA is activated on jeremiem@padok.fr
          status: OK
          resource_arn: jeremiem@padok.fr
        - message: 2FA is activated on manonf
          status: OK
          resource_arn: manonf
        - message: 2FA is activated on nathanl@padok.fr
          status: OK
          resource_arn: nathanl@padok.fr
        - message: 2FA is not activated on nicolasb
          status: FAIL
          resource_arn: nicolasb
        - message: 2FA is activated on oscarp
          status: OK
          resource_arn: oscarp
        - message: 2FA is not activated on thibaultp
          status: FAIL
          resource_arn: thibaultp
        - message: 2FA is activated on thibautr@padok.fr
          status: OK
          resource_arn: thibautr@padok.fr
        - message: 2FA is activated on thomasd
          status: OK
          resource_arn: thomasd
      duration: 12.257µs
      starttime: 2022-11-07T23:00:14.148951+01:00
      endtime: 2022-11-07T23:00:13.35306+01:00
    - name: IAM access key younger than 90 days
      description: Check if all users have access key less than 90 days
      status: FAIL
      id: AWS_IAM_002
      categories:
        - Security
        - Good Practice
      results:
        - message: Access key AKIAQ2RER5ITDVGKCW5F is younger than 90 days on anaell
          status: OK
          resource_arn: anaell
        - message: Access key AKIAQ2RER5ITLB3QD56X is younger than 90 days on antoinea@padok.fr
          status: OK
          resource_arn: antoinea@padok.fr
        - message: Access key AKIAQ2RER5ITBUW76OS6 is younger than 90 days on arthurh
          status: OK
          resource_arn: arthurh
        - message: Access key AKIAQ2RER5ITDSEJK44A is younger than 90 days on jeremiem@padok.fr
          status: OK
          resource_arn: jeremiem@padok.fr
        - message: Access key AKIAQ2RER5ITHXZFI2QB is older than 90 days on manonf
          status: FAIL
          resource_arn: manonf
        - message: Access key AKIAQ2RER5ITCXLF5QM4 is younger than 90 days on manonf
          status: OK
          resource_arn: manonf
        - message: Access key AKIAQ2RER5ITNQDPU2WM is younger than 90 days on nathanl@padok.fr
          status: OK
          resource_arn: nathanl@padok.fr
        - message: Access key AKIAQ2RER5ITJR5OUB6Z is older than 90 days on nicolasb
          status: FAIL
          resource_arn: nicolasb
        - message: Access key AKIAQ2RER5ITLF6C2YPM is younger than 90 days on oscarp
          status: OK
          resource_arn: oscarp
        - message: Access key AKIAQ2RER5ITH6X7IXE6 is younger than 90 days on oscarp
          status: OK
          resource_arn: oscarp
        - message: Access key AKIAQ2RER5ITB3FANQU3 is older than 90 days on thibaultp
          status: FAIL
          resource_arn: thibaultp
        - message: Access key AKIAQ2RER5ITAW7R3K52 is younger than 90 days on thibautr@padok.fr
          status: OK
          resource_arn: thibautr@padok.fr
        - message: Access key AKIAQ2RER5ITCTN4ELVI is younger than 90 days on thomasd
          status: OK
          resource_arn: thomasd
      duration: 21.293µs
      starttime: 2022-11-07T23:00:14.148961+01:00
      endtime: 2022-11-07T23:00:13.353094+01:00
    - name: IAM User can't elevate rights
      description: Check if  users can elevate rights
      status: FAIL
      id: AWS_IAM_003
      categories:
        - Security
        - Good Practice
      results:
        - message: User aurelienv can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: aurelienv
        - message: User thomasd can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: thomasd
        - message: User nicolasb can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: nicolasb
        - message: User manonf can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: manonf
        - message: User antoinea@padok.fr can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: antoinea@padok.fr
        - message: User anaell can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: anaell
        - message: User nathanl@padok.fr can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: nathanl@padok.fr
        - message: User oscarp can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: oscarp
        - message: User arthurh can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: arthurh
        - message: User jeremiem@padok.fr can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: jeremiem@padok.fr
        - message: User thibaultp can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: thibaultp
        - message: User thibautr@padok.fr can elevate rights with [[lambda:UpdateFunctionConfiguration] [sagemaker:CreateNotebookInstance sagemaker:CreatePresignedNotebookInstanceUrl iam:PassRole] [sagemaker:CreatePresignedNotebookInstanceUrl]] only last 3 policies
          status: FAIL
          resource_arn: thibautr@padok.fr
      duration: 75.947µs
      starttime: 2022-11-07T23:00:14.148963+01:00
      endtime: 2022-11-07T23:00:13.353138+01:00
    - name: IAM Users have not used their password for 120 days
      description: Check if all users have not used their password for 120 days
      status: FAIL
      id: AWS_IAM_004
      categories:
        - Security
        - Good Practice
      results:
        - message: Password has been used in the last 120 days on anaell
          status: OK
          resource_arn: anaell
        - message: Password has been used in the last 120 days on antoinea@padok.fr
          status: OK
          resource_arn: antoinea@padok.fr
        - message: Password has been used in the last 120 days on arthurh
          status: OK
          resource_arn: arthurh
        - message: Password has been used in the last 120 days on aurelienv
          status: OK
          resource_arn: aurelienv
        - message: Password has been used in the last 120 days on jeremiem@padok.fr
          status: OK
          resource_arn: jeremiem@padok.fr
        - message: Password has been used in the last 120 days on manonf
          status: OK
          resource_arn: manonf
        - message: Password has been used in the last 120 days on nathanl@padok.fr
          status: OK
          resource_arn: nathanl@padok.fr
        - message: Password has never been used on nicolasb
          status: FAIL
          resource_arn: nicolasb
        - message: Password has been used in the last 120 days on oscarp
          status: OK
          resource_arn: oscarp
        - message: Password has been used in the last 120 days on thibaultp
          status: OK
          resource_arn: thibaultp
        - message: Password has been used in the last 120 days on thibautr@padok.fr
          status: OK
          resource_arn: thibautr@padok.fr
        - message: Password has been used in the last 120 days on thomasd
          status: OK
          resource_arn: thomasd
      duration: 8.084µs
      starttime: 2022-11-07T23:00:14.148959+01:00
      endtime: 2022-11-07T23:00:13.35307+01:00
    - name: Lambdas are private
      description: Check if all Lambdas are private
      status: OK
      id: AWS_LMD_001
      categories:
        - Security
        - Good Practice
      results: []
      duration: 5.011µs
      starttime: 2022-11-07T23:00:14.148769+01:00
      endtime: 2022-11-07T23:00:04.654839+01:00
    - name: Lambdas are in a security group
      description: Check if all Lambdas are in a security group
      status: OK
      id: AWS_LMD_002
      categories:
        - Security
        - Good Practice
      results: []
      duration: 3.096µs
      starttime: 2022-11-07T23:00:14.148769+01:00
      endtime: 2022-11-07T23:00:04.65485+01:00
    - name: Lambdas are not with errors
      description: Check if all Lambdas are running smoothly
      status: OK
      id: AWS_LMD_003
      categories:
        - Security
        - Good Practice
      results: []
      duration: 19.149µs
      starttime: 2022-11-07T23:00:14.14877+01:00
      endtime: 2022-11-07T23:00:04.654873+01:00
    - name: RDS are encrypted
      description: Check if RDS encryption is enabled
      status: OK
      id: AWS_RDS_001
      categories:
        - Security
        - Good Practice
      results:
        - message: RDS encryption is enabled on database-1
          status: OK
          resource_arn: arn:aws:rds:eu-west-3:056984988198:db:database-1
      duration: 9.493µs
      starttime: 2022-11-07T23:00:14.148793+01:00
      endtime: 2022-11-07T23:00:04.936959+01:00
    - name: RDS are backedup automatically with PITR
      description: Check if RDS backup is enabled
      status: OK
      id: AWS_RDS_002
      categories:
        - Security
        - Good Practice
      results:
        - message: RDS backup is enabled on database-1
          status: OK
          resource_arn: arn:aws:rds:eu-west-3:056984988198:db:database-1
      duration: 19.526µs
      starttime: 2022-11-07T23:00:14.148793+01:00
      endtime: 2022-11-07T23:00:04.936951+01:00
    - name: RDS have minor versions automatically updated
      description: Check if RDS minor auto upgrade is enabled
      status: OK
      id: AWS_RDS_003
      categories:
        - Security
        - Good Practice
      results:
        - message: RDS auto upgrade is enabled on database-1
          status: OK
          resource_arn: arn:aws:rds:eu-west-3:056984988198:db:database-1
      duration: 7.948µs
      starttime: 2022-11-07T23:00:14.148794+01:00
      endtime: 2022-11-07T23:00:04.936963+01:00
    - name: RDS aren't publicly accessible
      description: Check if RDS private is enabled
      status: FAIL
      id: AWS_RDS_004
      categories:
        - Security
        - Good Practice
      results:
        - message: RDS private is not enabled on database-1
          status: FAIL
          resource_arn: arn:aws:rds:eu-west-3:056984988198:db:database-1
      duration: 9.995µs
      starttime: 2022-11-07T23:00:14.148794+01:00
      endtime: 2022-11-07T23:00:04.936971+01:00
    - name: RDS logs are exported to cloudwatch
      description: Check if RDS logging is enabled
      status: FAIL
      id: AWS_RDS_005
      categories:
        - Security
        - Good Practice
      results:
        - message: RDS logging is not enabled on database-1
          status: FAIL
          resource_arn: arn:aws:rds:eu-west-3:056984988198:db:database-1
      duration: 4.913µs
      starttime: 2022-11-07T23:00:14.148818+01:00
      endtime: 2022-11-07T23:00:04.937003+01:00
    - name: RDS have the deletion protection enabled
      description: Check if RDS delete protection is enabled
      status: FAIL
      id: AWS_RDS_006
      categories:
        - Security
        - Good Practice
      results:
        - message: RDS delete protection is not enabled on database-1
          status: FAIL
          resource_arn: arn:aws:rds:eu-west-3:056984988198:db:database-1
      duration: 8.779µs
      starttime: 2022-11-07T23:00:14.148817+01:00
      endtime: 2022-11-07T23:00:04.937002+01:00
    - name: Aurora Clusters have minor versions automatically updated
      description: Check if Aurora RDS minor auto upgrade is enabled
      status: OK
      id: AWS_RDS_007
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.499µs
      starttime: 2022-11-07T23:00:14.148795+01:00
      endtime: 2022-11-07T23:00:04.936977+01:00
    - name: Aurora RDS are backedup automatically with PITR
      description: Check if Aurora RDS backup is enabled
      status: OK
      id: AWS_RDS_008
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.864µs
      starttime: 2022-11-07T23:00:14.148794+01:00
      endtime: 2022-11-07T23:00:04.93697+01:00
    - name: Aurora RDS have the deletion protection enabled
      description: Check if Aurora RDS delete protection is enabled
      status: OK
      id: AWS_RDS_009
      categories:
        - Security
        - Good Practice
      results: []
      duration: 3.447µs
      starttime: 2022-11-07T23:00:14.148795+01:00
      endtime: 2022-11-07T23:00:04.936981+01:00
    - name: Aurora RDS are encrypted
      description: Check if Aurora RDS encryption is enabled
      status: OK
      id: AWS_RDS_010
      categories:
        - Security
        - Good Practice
      results: []
      duration: 18.141µs
      starttime: 2022-11-07T23:00:14.148817+01:00
      endtime: 2022-11-07T23:00:04.937001+01:00
    - name: Aurora RDS logs are exported to cloudwatch
      description: Check if Aurora RDS logging is enabled
      status: OK
      id: AWS_RDS_011
      categories:
        - Security
        - Good Practice
      results: []
      duration: 2.663µs
      starttime: 2022-11-07T23:00:14.148817+01:00
      endtime: 2022-11-07T23:00:04.936983+01:00
    - name: Aurora RDS aren't publicly accessible
      description: Check if Aurora RDS private is enabled
      status: OK
      id: AWS_RDS_012
      categories:
        - Security
        - Good Practice
      results: []
      duration: 1.772µs
      starttime: 2022-11-07T23:00:14.148817+01:00
      endtime: 2022-11-07T23:00:04.936987+01:00
    - name: S3 are encrypted
      description: Check if S3 encryption is enabled
      status: FAIL
      id: AWS_S3_001
      categories:
        - Security
        - Good Practice
      results:
        - message: S3 bucket cdk-hnb659fds-assets-056984988198-eu-west-3 is using encryption
          status: OK
          resource_arn: cdk-hnb659fds-assets-056984988198-eu-west-3
        - message: S3 bucket cdktoolkit-stagingbucket-1ruc2qea9gqzp is using encryption
          status: OK
          resource_arn: cdktoolkit-stagingbucket-1ruc2qea9gqzp
        - message: S3 bucket static-web-page.padok is not using encryption
          status: FAIL
          resource_arn: static-web-page.padok
        - message: S3 bucket static-website-nathanl is not using encryption
          status: FAIL
          resource_arn: static-website-nathanl
        - message: S3 bucket waf-test-wizz-anael is not using encryption
          status: FAIL
          resource_arn: waf-test-wizz-anael
      duration: 26.563µs
      starttime: 2022-11-07T23:00:14.148965+01:00
      endtime: 2022-11-07T23:00:14.138305+01:00
    - name: S3 buckets are not global but in one zone
      description: Check if S3 buckets are in one zone
      status: FAIL
      id: AWS_S3_002
      categories:
        - Security
        - Good Practice
      results:
        - message: S3 bucket cdk-hnb659fds-assets-056984988198-eu-west-1 is global but should be in eu-west-3
          status: FAIL
          resource_arn: cdk-hnb659fds-assets-056984988198-eu-west-1
        - message: S3 bucket cdk-hnb659fds-assets-056984988198-eu-west-3 is in eu-west-3
          status: OK
          resource_arn: cdk-hnb659fds-assets-056984988198-eu-west-3
        - message: S3 bucket cdktoolkit-stagingbucket-1ruc2qea9gqzp is in eu-west-3
          status: OK
          resource_arn: cdktoolkit-stagingbucket-1ruc2qea9gqzp
        - message: S3 bucket manon-test-2022-08-16 is global but should be in eu-west-3
          status: FAIL
          resource_arn: manon-test-2022-08-16
        - message: S3 bucket static-web-page.padok is in eu-west-3
          status: OK
          resource_arn: static-web-page.padok
        - message: S3 bucket static-website-nathanl is in eu-west-3
          status: OK
          resource_arn: static-website-nathanl
        - message: S3 bucket test-blatantly-cuddly-eft is global but should be in eu-west-3
          status: FAIL
          resource_arn: test-blatantly-cuddly-eft
        - message: S3 bucket waf-test-wizz-anael is in eu-west-3
          status: OK
          resource_arn: waf-test-wizz-anael
      duration: 10.764µs
      starttime: 2022-11-07T23:00:14.148978+01:00
      endtime: 2022-11-07T23:00:14.138348+01:00
    - name: S3 buckets are versioned
      description: Check if S3 buckets are using object versioning
      status: FAIL
      id: AWS_S3_003
      categories:
        - Security
        - Good Practice
      results:
        - message: S3 bucket cdk-hnb659fds-assets-056984988198-eu-west-3 is using object versioning
          status: OK
          resource_arn: cdk-hnb659fds-assets-056984988198-eu-west-3
        - message: S3 bucket cdktoolkit-stagingbucket-1ruc2qea9gqzp is not using object versioning
          status: FAIL
          resource_arn: cdktoolkit-stagingbucket-1ruc2qea9gqzp
        - message: S3 bucket static-web-page.padok is not using object versioning
          status: FAIL
          resource_arn: static-web-page.padok
        - message: S3 bucket static-website-nathanl is not using object versioning
          status: FAIL
          resource_arn: static-website-nathanl
        - message: S3 bucket waf-test-wizz-anael is not using object versioning
          status: FAIL
          resource_arn: waf-test-wizz-anael
      duration: 15.342µs
      starttime: 2022-11-07T23:00:14.148967+01:00
      endtime: 2022-11-07T23:00:14.138321+01:00
    - name: S3 buckets have a retention policy
      description: Check if S3 buckets are using retention policy
      status: FAIL
      id: AWS_S3_004
      categories:
        - Security
        - Good Practice
      results:
        - message: S3 bucket cdk-hnb659fds-assets-056984988198-eu-west-3 is not using retention policy
          status: FAIL
          resource_arn: cdk-hnb659fds-assets-056984988198-eu-west-3
        - message: S3 bucket cdktoolkit-stagingbucket-1ruc2qea9gqzp is not using retention policy
          status: FAIL
          resource_arn: cdktoolkit-stagingbucket-1ruc2qea9gqzp
        - message: S3 bucket static-web-page.padok is not using retention policy
          status: FAIL
          resource_arn: static-web-page.padok
        - message: S3 bucket static-website-nathanl is not using retention policy
          status: FAIL
          resource_arn: static-website-nathanl
        - message: S3 bucket waf-test-wizz-anael is not using retention policy
          status: FAIL
          resource_arn: waf-test-wizz-anael
      duration: 19.48µs
      starttime: 2022-11-07T23:00:14.148968+01:00
      endtime: 2022-11-07T23:00:14.138331+01:00
    - name: S3 bucket have public access block enabled
      description: Check if S3 buckets are using Public Access Block
      status: OK
      id: AWS_S3_005
      categories:
        - Security
        - Good Practice
      results:
        - message: S3 bucket cdk-hnb659fds-assets-056984988198-eu-west-3 is using Public Access Block
          status: OK
          resource_arn: cdk-hnb659fds-assets-056984988198-eu-west-3
        - message: S3 bucket cdktoolkit-stagingbucket-1ruc2qea9gqzp is using Public Access Block
          status: OK
          resource_arn: cdktoolkit-stagingbucket-1ruc2qea9gqzp
        - message: S3 bucket static-web-page.padok is using Public Access Block
          status: OK
          resource_arn: static-web-page.padok
        - message: S3 bucket static-website-nathanl is using Public Access Block
          status: OK
          resource_arn: static-website-nathanl
        - message: S3 bucket waf-test-wizz-anael is using Public Access Block
          status: OK
          resource_arn: waf-test-wizz-anael
      duration: 9.63µs
      starttime: 2022-11-07T23:00:14.148973+01:00
      endtime: 2022-11-07T23:00:14.138339+01:00
    - name: EC2's volumes are encrypted
      description: Check if EC2 encryption is enabled
      status: FAIL
      id: AWS_VOL_001
      categories:
        - Security
        - Good Practice
      results:
        - message: EC2 encryption is not enabled on vol-05e2ed98f2cb26bc7
          status: FAIL
          resource_arn: vol-05e2ed98f2cb26bc7
      duration: 2.5µs
      starttime: 2022-11-07T23:00:14.148819+01:00
      endtime: 2022-11-07T23:00:05.058067+01:00
    - name: EC2 are using GP3
      description: Check if all volumes are of type gp3
      status: FAIL
      id: AWS_VOL_002
      categories:
        - Security
        - Good Practice
      results:
        - message: Volume vol-05e2ed98f2cb26bc7 is not of type gp3
          status: FAIL
          resource_arn: vol-05e2ed98f2cb26bc7
      duration: 2.536µs
      starttime: 2022-11-07T23:00:14.14882+01:00
      endtime: 2022-11-07T23:00:05.058076+01:00
    - name: EC2 have snapshots
      description: Check if all volumes have snapshots
      status: FAIL
      id: AWS_VOL_003
      categories:
        - Security
        - Good Practice
      results:
        - message: Volume vol-05e2ed98f2cb26bc7 has no snapshot
          status: FAIL
          resource_arn: vol-05e2ed98f2cb26bc7
      duration: 24.881µs
      starttime: 2022-11-07T23:00:14.14882+01:00
      endtime: 2022-11-07T23:00:05.058103+01:00
    - name: EC2's volumes are unused
      description: Check if EC2 volumes are unused
      status: OK
      id: AWS_VOL_004
      categories:
        - Security
        - Good Practice
      results:
        - message: EC2 volume is in use vol-05e2ed98f2cb26bc7
          status: OK
          resource_arn: vol-05e2ed98f2cb26bc7
      duration: 4.995µs
      starttime: 2022-11-07T23:00:14.148818+01:00
      endtime: 2022-11-07T23:00:05.058035+01:00
    - name: VPC CIDRs are bigger than /20
      description: Check if VPC CIDR is /20 or bigger
      status: OK
      id: AWS_VPC_001
      categories:
        - Security
        - Good Practice
      results:
        - message: VPC CIDR is /20 or bigger on vpc-0e2e66fb880028889
          status: OK
          resource_arn: vpc-0e2e66fb880028889
        - message: VPC CIDR is /20 or bigger on vpc-0affec3848e86880c
          status: OK
          resource_arn: vpc-0affec3848e86880c
        - message: VPC CIDR is /20 or bigger on vpc-0c69e467376a3d597
          status: OK
          resource_arn: vpc-0c69e467376a3d597
      duration: 60.604µs
      starttime: 2022-11-07T23:00:14.14895+01:00
      endtime: 2022-11-07T23:00:06.542379+01:00
    - name: VPC can't be in the same account
      description: Check if VPC has only one VPC
      status: FAIL
      id: AWS_VPC_002
      categories:
        - Security
        - Good Practice
      results:
        - message: VPC Id:vpc-0e2e66fb880028889
          status: FAIL
          resource_arn: vpc-0e2e66fb880028889
        - message: VPC Id:vpc-0affec3848e86880c
          status: FAIL
          resource_arn: vpc-0affec3848e86880c
        - message: VPC Id:vpc-0c69e467376a3d597
          status: FAIL
          resource_arn: vpc-0c69e467376a3d597
      duration: 12.632µs
      starttime: 2022-11-07T23:00:14.148948+01:00
      endtime: 2022-11-07T23:00:06.542338+01:00
    - name: VPC only have one Gateway
      description: Check if VPC has only one gateway
      status: OK
      id: AWS_VPC_003
      categories:
        - Security
        - Good Practice
      results:
        - message: VPC has only one gateway on vpc-0e2e66fb880028889
          status: OK
          resource_arn: vpc-0e2e66fb880028889
        - message: VPC has only one gateway on vpc-0affec3848e86880c
          status: OK
          resource_arn: vpc-0affec3848e86880c
        - message: VPC has only one gateway on vpc-0c69e467376a3d597
          status: OK
          resource_arn: vpc-0c69e467376a3d597
      duration: 8.755µs
      starttime: 2022-11-07T23:00:14.148826+01:00
      endtime: 2022-11-07T23:00:06.542282+01:00
    - name: VPC Flow Logs are activated
      description: Check if VPC Flow Logs are enabled
      status: FAIL
      id: AWS_VPC_004
      categories:
        - Security
        - Good Practice
      results:
        - message: VPC Flow Logs are not enabled on vpc-0e2e66fb880028889
          status: FAIL
          resource_arn: vpc-0e2e66fb880028889
        - message: VPC Flow Logs are not enabled on vpc-0affec3848e86880c
          status: FAIL
          resource_arn: vpc-0affec3848e86880c
        - message: VPC Flow Logs are not enabled on vpc-0c69e467376a3d597
          status: FAIL
          resource_arn: vpc-0c69e467376a3d597
      duration: 4.632µs
      starttime: 2022-11-07T23:00:14.148828+01:00
      endtime: 2022-11-07T23:00:06.542301+01:00
    - name: VPC have at least 2 subnets
      description: Check if VPC has at least 2 subnets
      status: FAIL
      id: AWS_VPC_005
      categories:
        - Security
        - Good Practice
      results:
        - message: VPC vpc-0e2e66fb880028889 has at least 2 subnets
          status: OK
          resource_arn: vpc-0e2e66fb880028889
        - message: VPC vpc-0affec3848e86880c has less than 2 subnets
          status: FAIL
          resource_arn: vpc-0affec3848e86880c
        - message: VPC vpc-0c69e467376a3d597 has at least 2 subnets
          status: OK
          resource_arn: vpc-0c69e467376a3d597
      duration: 6.812µs
      starttime: 2022-11-07T23:00:14.148947+01:00
      endtime: 2022-11-07T23:00:06.542319+01:00
    - name: VPC's Subnets are in different zones
      description: Check if Subnet are in different zone
      status: FAIL
      id: AWS_VPC_006
      categories:
        - Security
        - Good Practice
      results:
        - message: Subnets are in different zone on vpc-0e2e66fb880028889
          status: OK
          resource_arn: vpc-0e2e66fb880028889
        - message: Subnets are in same zone on vpc-0affec3848e86880c
          status: FAIL
          resource_arn: vpc-0affec3848e86880c
        - message: Subnets are in different zone on vpc-0c69e467376a3d597
          status: OK
          resource_arn: vpc-0c69e467376a3d597
      duration: 12.828µs
      starttime: 2022-11-07T23:00:14.148949+01:00
      endtime: 2022-11-07T23:00:06.542343+01:00
